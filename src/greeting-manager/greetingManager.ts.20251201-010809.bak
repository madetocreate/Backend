import { GreetingCard } from "./greetingTypes";

export interface GreetingContext {
  userId: string;
  locale: string;
  now: string;
}

export interface GreetingManagerDeps {
  loadUserProfile: (userId: string) => Promise<unknown>;
  loadMemorySummary: (userId: string) => Promise<unknown>;
  planTopics: (context: GreetingContext) => Promise<unknown>;
  fetchNews: (context: GreetingContext, topicPlan: unknown) => Promise<unknown>;
}

export async function buildGreetingFeed(
  context: GreetingContext,
  deps: GreetingManagerDeps
): Promise<GreetingCard[]> {
  const profile = await deps.loadUserProfile(context.userId);
  const memory = await deps.loadMemorySummary(context.userId);
  const topicPlan = await deps.planTopics(context);
  const news = await deps.fetchNews(context, topicPlan);
  const cards: GreetingCard[] = [];
  return cards;
}
